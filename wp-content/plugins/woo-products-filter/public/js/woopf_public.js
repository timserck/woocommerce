/**
 * All of the code for your public-facing JavaScript source
 * should reside in this file.
 * 
 * @link       http://theemon.com/p/Woo-Products-filter/LivePreview
 * @since      1.0.0
 *
 * @package    woo-products-filter
 * @subpackage woo-products-filter/public/js 
 */
!function($){"use strict";function woopf_filter_terms_init(e){e=null==e?$($("#woopf_woocommerce").length>0?"#woopf_woocommerce":".woopf_woocommerce"):e,e.each(function(){var e=$(this);e.hasClass("woopf_search_fields")&&e.find(".woopf_filter:not(.woopf_range, .woopf_byprice, .woopf_orderby, .woopf_instock, .woopf_per_page) .woopf_checkboxes").each(function(){var e=$(this);woopf_filter_terms(e)})})}function woopf_init_tooltips(e){e=null==e?$($("#woopf_woocommerce").length>0?"#woopf_woocommerce":".woopf_woocommerce"):e,e.each(function(){var e=$(this),r=e.find(".woopf_filter.pf_attr_img label");r.on("mouseover",function(){var e=$(this);e.prop("hoverTimeout")&&e.prop("hoverTimeout",clearTimeout(e.prop("hoverTimeout"))),e.prop("hoverIntent",setTimeout(function(){e.addClass("woopf_hover")},250))}).on("mouseleave",function(){var e=$(this);e.prop("hoverIntent")&&e.prop("hoverIntent",clearTimeout(e.prop("hoverIntent"))),e.prop("hoverTimeout",setTimeout(function(){e.removeClass("woopf_hover")},250))})})}function woopf_init_scroll(e){e=null==e?$("#woopf_woocommerce"):e,e.hasClass("woopf_scroll_active")&&e.find(".woopf_filter:not(.woopf_range) .woopf_checkboxes").mCustomScrollbar({axis:"y",scrollInertia:550,autoExpandScrollbar:!0,advanced:{updateOnBrowserResize:!0,updateOnContentResize:!0}})}function woopf_show_opened_cats(e){e=null==e?$("#woopf_woocommerce"):e,e.find("label.woopf_active.woopf_clicked").each(function(){$(this).next().show()}),e.find(".woopf_sub label.woopf_active").each(function(){var e=$(this).parent();e.is(":visible")||(e.show(),e.prev().hasClass("woopf_clicked")||e.prev().addClass("woopf_clicked"))})}function woopf_all_cats(e){e=null==e?$("#woopf_woocommerce"):e,e.find(".woopf_filter.woopf_cat.woopf_expand_parents .woopf_sub").each(function(){var e=$(this);e.is(":visible")||(e.show(),e.prev().hasClass("woopf_clicked")||e.prev().addClass("woopf_clicked"))})}function woopf_check(e,r,t){var c=e.closest(".woopf_woocommerce");if(e.hasClass("woopf_multi"))if(""!==r.val())if(r.parent().hasClass("woopf_active")){if(e.hasClass("woopf_merge_terms"))var s=e.children(":first").val().indexOf("+")>0?e.children(":first").val().replace("+"+t,"").replace(t+"+",""):"";else var s=e.children(":first").val().indexOf(",")>0?e.children(":first").val().replace(","+t,"").replace(t+",",""):"";var i=e.children(":first").attr("name"),n=r.attr("value");c.find('input[name="'+i+'"]').val(s),c.find('.woopf_filter[data-filter="'+i+'"] input[value="'+n+'"]').prop("checked",!1).parent().removeClass("woopf_active")}else{if(e.hasClass("woopf_merge_terms"))var s=""==e.children(":first").val()?t:e.children(":first").val()+"+"+t;else var s=""==e.children(":first").val()?t:e.children(":first").val()+","+t;var i=e.children(":first").attr("name"),n=r.attr("value");c.find('input[name="'+i+'"]').val(s),c.find('.woopf_filter[data-filter="'+i+'"] input[value="'+n+'"]').prop("checked",!0).parent().addClass("woopf_active")}else{var i=e.children(":first").attr("name");c.find('.woopf_filter[data-filter="'+i+'"] input[name="'+i+'"]').each(function(){var e=$(this);e.val(""),e.closest(".woopf_filter").find('input:not([type="hidden"])').prop("checked",!1).change().parent().removeClass("woopf_active")})}else if(""==r.val()){var i=e.children(":first").attr("name");c.find('.woopf_filter[data-filter="'+i+'"] input[name="'+i+'"]').each(function(){var e=$(this);e.val(""),e.closest(".woopf_filter").find('input:not([type="hidden"]):checked').prop("checked",!1).change().parent().removeClass("woopf_active")})}else if(r.parent().hasClass("woopf_active")){var i=e.children(":first").attr("name"),n=r.attr("value");c.find('.woopf_filter[data-filter="'+i+'"] input[name="'+i+'"]').each(function(){var e=$(this);e.val(""),e.closest(".woopf_filter").find('input[value="'+n+'"]').prop("checked",!1).change().parent().removeClass("woopf_active")})}else{var i=e.children(":first").attr("name"),n=r.attr("value");c.find('.woopf_filter[data-filter="'+i+'"] input[name="'+i+'"]').each(function(){var e=$(this);e.val(t),e.closest(".woopf_filter").find('input:not([type="hidden"])').prop("checked",!1).change().parent().removeClass("woopf_active"),e.closest(".woopf_filter").find('input[value="'+n+'"]').prop("checked",!0).change().parent().addClass("woopf_active")})}woopf_submit_form(c)}function woopf_submit_form(e){if(e=null==e?$("#woopf_woocommerce"):e,e.hasClass("woopf_click_filter")||e.find('input[name="reset_filter"]:checked').length>0){var r=e.find(".woopf_woocommerce_ordering");woopf_respond(r)}}function woopf_respond(curr){if(curr.find('input[name="reset_filter"]:checked').length>0)curr.find('input[name="reset_filter"]').remove(),curr.find('input[type="hidden"], input[name="sale_products"], input[name="instock_products"]:not([type="hidden"])').remove();else{var curr_check=[];curr.find('.woopf_filter input[type="hidden"], .woopf_add_inputs input[type="hidden"]:not([name="post_type"])').each(function(){var e=$(this).attr("name"),r=$(this).val();""==r?$(this).remove():-1==$.inArray(e,curr_check)?curr_check.push(e):$(this).remove()})}if(curr.find(".woopf_filter.woopf_range").each(function(){var e=$(this);(void 0==e.find('[name^="rng_min_"]').val()||void 0==e.find('[name^="rng_max_"]').val())&&e.find("input").remove()}),""==woopf.ajax_class)var curr_class=".products";else var curr_class=woopf.ajax_class;if(curr.closest(".woopf_sc_products").length>0&&curr.closest(".woopf_sc_products").hasClass("woopf_ajax")||$(".woopf_sc_products:first").length>0&&$(".woopf_sc_products:first").hasClass("woopf_ajax")||$(curr_class+":first").length>0&&"yes"==woopf.use_ajax&&$("body").hasClass("archive")&&$("body").hasClass("woocommerce")){var curr_loader=curr.closest(".woopf_woocommerce").attr("data-loader");curr.closest(".woopf_woocommerce").find(".woopf_woocommerce_filter i").length>0?(curr.closest(".woopf_woocommerce").find(".woopf_woocommerce_filter").addClass("pf_ajax_loading"),curr.closest(".woopf_woocommerce").find(".woopf_woocommerce_filter i").replaceWith('<img src="'+woopf.url+"/svg-loaders/"+curr_loader+'.svg" class="woopf_reset_this woopf_loader" />')):curr.closest(".woopf_woocommerce").prepend('<img src="'+woopf.url+"/svg-loaders/"+curr_loader+'.svg" class="woopf_reset_this woopf_loader" />');var curr_sc=curr.closest(".woopf_sc_products").length>0?curr.closest(".woopf_sc_products"):$(".woopf_sc_products:first").length>0?$(".woopf_sc_products:first"):curr.closest(".woopf_woocommerce"),curr_fields={};curr.find('.woopf_filter input[type="hidden"]').each(function(){""!==$(this).attr("value")&&(curr_fields[$(this).attr("name")]=$(this).attr("value"))}),curr.find('input[name="sale_products"]:checked').length>0&&(curr_fields.sale_products="on"),curr.find('input[name="instock_products"]:checked').length>0&&(curr_fields.instock_products="in");var data={action:"woopf_respond",pf_query:curr_sc.attr("data-query"),pf_shortcode:curr_sc.attr("data-shortcode"),pf_page:void 0!==curr_data.paginated?curr_sc.attr("data-page"):1,pf_filters:curr_fields,pf_mode:"woopf_woocommerce"==curr.closest(".woopf_woocommerce").attr("id")?"yes":"no"};$.post(woopf.ajax,data,function(response){if(response){var curr_response=$(response);if(""==woopf.ajax_product_class)var curr_product_class=".type-product";else var curr_product_class=woopf.ajax_product_class;if($(".woopf_sc_products:first").length>0){var curr_next=curr_sc.next();curr_next.css({position:"absolute",top:0,left:0});var curr_products=curr_next.find(curr_product_class).length>0?curr_next.find(curr_product_class):curr_next.find("li");curr_products.css("opacity",0),curr_sc.css({position:"absolute",top:0,left:0}).fadeOut(100).remove(),curr_next.removeAttr("style"),curr_next=curr_next.find(".woopf_woocommerce")}else{if(curr_response.find(".woopf_woocommerce").length>0){$(".woopf_woocommerce:first").replaceWith(curr_response.find(".woopf_woocommerce"));var curr_next=$(".woopf_woocommerce:first")}else var curr_next=$(curr_class+":first");if(curr_response.find(curr_class+":first").length>0){$(curr_class+":first").replaceWith(curr_response.find(curr_class+":first"));var curr_products=$(curr_class+":first").find(curr_product_class).length>0?$(curr_class+":first").find(curr_product_class):$(curr_class+":first").find("li");void 0!==curr_products&&curr_products.css("opacity",0)}curr_response.find(".woocommerce-pagination").length>0?$(".woocommerce-pagination").length>0?$(".woocommerce-pagination:first").replaceWith(curr_response.find(".woocommerce-pagination")):$(curr_class+":first").after(curr_response.find(".woocommerce-pagination")):$(".woocommerce-pagination:first").remove()}""!==woopf.js&&eval(woopf.js),curr.find(".woopf_filter.woopf_cat.woopf_expand_parents").length>0?woopf_all_cats(curr_next):woopf_show_opened_cats(curr_next),woopf_init_scroll(curr_next),woopf_filter_terms_init(curr_next),woopf_init_tooltips(curr_next),void 0!==curr_next&&(curr_next.hasClass("pf_mod_masonry")&&(curr_next.find(".woopf_woocommerce_ordering").show(),curr_next.find(".woopf_filter_inner").isotope({resizable:!1,masonry:{}}),curr_next.hasClass("woopf_always_visible")||curr_next.find(".woopf_woocommerce_ordering").hide()),void 0!==curr_products&&curr_products.each(function(e){$(this).delay(100*e++).fadeTo(100,1)}))}else alert("Error!")})}else curr.find('.woopf_filter input[type="hidden"]').each(function(){curr.find(".woopf_add_inputs input[name="+$(this).attr("name")+"]").length>0&&curr.find(".woopf_add_inputs input[name="+$(this).attr("name")+"]").remove()}),curr.submit();return!1}function woopf_filter_terms(e){var r=e.closest(".woopf_wc"),t=$("<form>").attr({"class":"woopf_search_terms",action:"#"}),c=$("<input>").attr({"class":"woopf_search_terms_input woopf_reset_this",type:"text",placeholder:woopf.localization.filter_terms});r.hasClass("pf_select")||r.hasClass("pf_default_select")?$(t).append("<i class='woopf-search'></i>").append(c).prependTo(e):$(t).append("<i class='woopf-search'></i>").append(c).insertBefore(e),$(c).change(function(){var r=$(this).val();return r?($(e).find("label > span:not(:Contains("+r+"))").closest("label").slideUp(50),$(e).find("label > span:Contains("+r+")").closest("label").slideDown(50)):$(e).find("label > span").closest("label").slideDown(50),!1}).keyup(function(){$(this).change()})}var curr_data={};$.expr[":"].Contains=function(e,r,t){return(e.textContent||e.innerText||"").toUpperCase().indexOf(t[3].toUpperCase())>=0},String.prototype.getValueByKey=function(e){var r=new RegExp("\\b"+e+"\\b","gi");return-1!=this.search(r)?decodeURIComponent(this.substr(this.search(r)+e.length+1).substr(0,this.substr(this.search(r)+e.length+1).search(/(&|;|$)/))):""},woopf_filter_terms_init(),woopf_init_tooltips(),$(".woopf_woocommerce").each(function(){var e=$(this);woopf_init_scroll(e),e.find(".woopf_filter.woopf_cat.woopf_expand_parents").length>0?woopf_all_cats(e):woopf_show_opened_cats(e),e.hasClass("pf_mod_masonry")&&(e.find(".woopf_filter_inner").isotope({resizable:!1,masonry:{}}),e.hasClass("woopf_always_visible")||e.find(".woopf_woocommerce_ordering").hide())}),$(document).on("click",".woopf_woocommerce_filter_submit",function(){var e=$(this).parent().parent();return woopf_respond(e),!1}),$(document).on("click",".woopf_woocommerce_filter",function(){var e=$(this).closest(".woopf_woocommerce");if(e.hasClass("pf_mod_masonry")){var r=e.find(".woopf_filter_inner").height();if(0==r){var t=e.find(".woopf_woocommerce_ordering");t.show().find(".woopf_filter_inner").isotope("layout"),t.hide()}}return!1}),$(document).on("click",'span.woopf_sale input[type="checkbox"], span.woopf_instock input[type="checkbox"], span.woopf_reset input[type="checkbox"]',function(){var e=$(this).parent(),r=$(this).closest(".woopf_woocommerce");e.hasClass("woopf_active")?e.removeClass("woopf_active"):e.addClass("woopf_active"),woopf_submit_form(r)}),$(document).on("click",'.woopf_instock:not(span) input[type="checkbox"], .woopf_orderby:not(span) input[type="checkbox"], .woopf_per_page:not(span) input[type="checkbox"]',function(){var e=$(this),r=e.closest(".woopf_filter"),t=e.val(),c=e.closest(".woopf_woocommerce");e.parent().hasClass("woopf_active")?(r.children(":first").val(""),r.find('input:not([type="hidden"])').prop("checked",!1),r.find("label").removeClass("woopf_active")):(r.children(":first").val(t),r.find('input:not([type="hidden"])').prop("checked",!1),r.find("label").removeClass("woopf_active"),e.prop("checked",!0),e.parent().addClass("woopf_active")),woopf_submit_form(c)}),$(document).on("click",'.woopf_byprice input[type="checkbox"]',function(){var e=$(this),r=e.closest(".woopf_filter"),t=e.val().split("-"),c=e.closest(".woopf_woocommerce");e.parent().hasClass("woopf_active")?(r.children(":first").val(""),r.children(":first").next().val(""),r.find('input:not([type="hidden"])').prop("checked",!1),r.find("label").removeClass("woopf_active")):(r.children(":first").val(t[0]),r.children(":first").next().val(t[1]),r.find('input:not([type="hidden"])').prop("checked",!1),r.find("label").removeClass("woopf_active"),e.prop("checked",!0),e.parent().addClass("woopf_active")),woopf_submit_form(c)}),$(document).on("click",'.woopf_characteristics input[type="checkbox"], .woopf_tag input[type="checkbox"], .woopf_cat input[type="checkbox"], .woopf_attributes input[type="checkbox"]',function(){var e=$(this),r=e.closest(".woopf_filter"),t=e.val(),c=r.closest(".woopf_woocommerce");return c.hasClass("pf_adptv_unclick")&&e.parent().hasClass("pf_adoptive_hide")?!1:void woopf_check(r,e,t)}),$(document).on("click",".woopf_filter_title a.woopf_title_remove",function(){var e=$(this).closest(".woopf_woocommerce").find(".woopf_woocommerce_ordering"),r=$(this).attr("data-key");return"byprice"==r?e.find('.woopf_byprice input[type="hidden"], .woopf_price input[type="hidden"]').each(function(){$(this).remove()}):"products_per_page"==r?e.find('.woopf_per_page input[type="hidden"]').each(function(){$(this).remove()}):"product_cat"==r?e.find(".woopf_"+r+' input[type="hidden"], .woopf_cat input[type="hidden"], .woopf_add_inputs input[name="product_cat"]').each(function(){$(this).remove()}):"product_tag"==r?e.find(".woopf_"+r+' input[type="hidden"], .woopf_tag input[type="hidden"]').each(function(){$(this).remove()}):"instock_products"==r?e.find('.woopf_filter.woopf_instock input[type="hidden"], span.woopf_instock input[type="checkbox"]').each(function(){$(this).remove()}):"sale_products"==r?e.find('span.woopf_sale input[type="checkbox"]').each(function(){$(this).remove()}):"rng_"==r.substr(0,4)?e.find('.woopf_range input[type="hidden"][name$="'+r.substr(4,r.length)+'"]').each(function(){$(this).remove()}):e.find(".woopf_"+r+' input[type="hidden"]').each(function(){$(this).remove()}),woopf_respond(e),!1}),$(document).on("click",".woopf_checkboxes label > i",function(){var e=$(this).parent().next();return $(this).parent().toggleClass("woopf_clicked"),e.hasClass("woopf_sub")&&e.slideToggle(100,function(){e.closest(".woopf_woocommerce").hasClass("pf_mod_masonry")&&e.closest(".woopf_woocommerce").find(".woopf_filter_inner").isotope("layout")}),!1}),$(document).on("click",".woopf_sc_products .woocommerce-pagination a, .archive.woocommerce .woocommerce-pagination a",function(){var curr=$(this).closest(".woocommerce-pagination"),curr_sc=curr.closest(".woopf_sc_products").length>0?curr.closest(".woopf_sc_products"):$(".woopf_sc_products:first").length>0?$(".woopf_sc_products:first"):$(".woopf_woocommerce:first").length>0?$(".woopf_woocommerce:first"):"none";if("none"!=curr_sc&&"yes"==woopf.use_ajax&&0==$(".woopf_sc_products").length){var curr_filter=curr_sc,curr_loader=curr_sc.find(".woopf_woocommerce").attr("data-loader");if(curr_sc.find(".woopf_woocommerce").find(".woopf_woocommerce_filter i").length>0?(curr.closest(".woopf_woocommerce").find(".woopf_woocommerce_filter").addClass("pf_ajax_loading"),curr.closest(".woopf_woocommerce").find(".woopf_woocommerce_filter i").replaceWith('<img src="'+woopf.url+"/svg-loaders/"+curr_loader+'.svg" class="woopf_reset_this woopf_loader" />')):curr.closest(".woopf_woocommerce").prepend('<img src="'+woopf.url+"/svg-loaders/"+curr_loader+'.svg" class="woopf_reset_this woopf_loader" />'),null!==curr_filter){curr_filter.find('.woopf_filter input[type="hidden"], .woopf_add_inputs input[type="hidden"]:not([name="post_type"])').each(function(){var e=$(this).val();$(this).attr("name");""==e&&$(this).remove()});var curr_href=$(this).attr("href");if(!(curr_href.indexOf("paged=")>=0))return!1;var pf_paged=curr_href.getValueByKey("paged"),curr_fields={};curr_filter.find('.woopf_filter input[type="hidden"]').each(function(){""!==$(this).attr("value")&&(curr_fields[$(this).attr("name")]=$(this).attr("value"))}),curr_filter.find('input[name="sale_products"]:checked').length>0&&(curr_fields.sale_products="on"),curr_filter.find('input[name="instock_products"]:checked').length>0&&(curr_fields.instock_products="in");var data={action:"woopf_respond",pf_query:curr_sc.attr("data-query"),pf_shortcode:curr_sc.attr("data-shortcode"),pf_page:curr_sc.attr("data-page"),pf_action:curr_sc.attr("action"),pf_paged:pf_paged,pf_filters:curr_fields,pf_mode:"woopf_woocommerce"==curr.closest(".woopf_woocommerce").attr("id")?"yes":"no"};return data.pf_query=data.pf_query.replace("paged="+data.pf_page,"paged="+data.pf_paged),$.post(woopf.ajax,data,function(response){if(response){if($(".woopf_sc_products:first").length>0){var curr_response=$(response);curr_sc.after(curr_response);var curr_next=curr_sc.next();curr_next.css({position:"absolute",top:0,left:0});var curr_products=curr_next.find(".type-product").length>0?curr_next.find(".type-product"):curr_next.find("li");curr_products.css("opacity",0),curr_sc.css({position:"absolute",top:0,left:0}).fadeOut(100).remove(),curr_next.removeAttr("style"),curr_next=curr_next.find(".woopf_woocommerce")}else{var curr_response=$(response);if(curr_response.find(".woopf_woocommerce").length>0){$(".woopf_woocommerce:first").replaceWith(curr_response.find(".woopf_woocommerce"));var curr_next=$(".woopf_woocommerce:first")}if(""==woopf.ajax_class)var curr_class=".products";else var curr_class=woopf.ajax_class;if(""==woopf.ajax_product_class)var curr_product_class=".type-product";else var curr_product_class=woopf.ajax_product_class;if(curr_response.find(curr_class+":first").length>0){$(curr_class+":first").replaceWith(curr_response.find(curr_class+":first"));var curr_products=$(curr_class+":first").find(curr_product_class).length>0?$(curr_class+":first").find(curr_product_class):$(curr_class+":first").find("li");curr_products.css("opacity",0)}curr_response.find(".woocommerce-pagination").length>0?$(".woocommerce-pagination").length>0?$(".woocommerce-pagination:first").replaceWith(curr_response.find(".woocommerce-pagination")):$(curr_class+":first").after(curr_response.find(".woocommerce-pagination")):$(".woocommerce-pagination:first").remove()}""!==woopf.js&&eval(woopf.js),curr_next.find(".woopf_filter.woopf_cat.woopf_expand_parents").length>0?woopf_all_cats(curr_next):woopf_show_opened_cats(curr_next),woopf_init_scroll(curr_next),woopf_filter_terms_init(curr_next),woopf_init_tooltips(curr_next),void 0!==curr_next&&(curr_next.hasClass("pf_mod_masonry")&&(curr_next.find(".woopf_woocommerce_ordering").show(),curr_next.find(".woopf_filter_inner").isotope({resizable:!1,masonry:{}}),curr_next.hasClass("woopf_always_visible")||curr_next.find(".woopf_woocommerce_ordering").hide()),curr_products.each(function(e){$(this).delay(100*e++).fadeTo(100,1)})),1==curr_data.paginated}else alert("Error!")}),!1}}}),/Trident\/7\./.test(navigator.userAgent)&&$(document).on("click",".woopf_checkboxes label img",function(){$(this).parents("label").children("input:first").change().click()}),/Trident\/4\./.test(navigator.userAgent)&&$(document).on("click",".woopf_checkboxes label > span > img, .woopf_checkboxes label > span",function(){$(this).parents("label").children("input:first").change().click()}),$(window).load(function(){$(".pf_mod_masonry .woopf_filter_inner").each(function(){$(this).isotope("layout")})})}(jQuery);
