/**
 * All of the code for your Dashboard-specific JavaScript source
 * should reside in this file.
 * 
 * @link       http://theemon.com/p/Woo-Products-filter/LivePreview
 * @since      1.0.0
 *
 * @package    woo-products-filter
 * @subpackage woo-products-filter/admin/js
 */
!function(e){"use strict";function t(e,t){var a;for(a=0;a<t.length&&e[0]!==t[a];a++);return a>=t.length?-1:a}function a(t,a,n){switch(a){case"text":e(t).val(n);break;case"number":e(t).val(n);break;case"textarea":e(t).val(n);break;case"radio":e(t).val(n);break;case"checkbox":e(t).prop("checked","yes"==n?!0:!1);break;case"select":e(t).val(n);break;case"multiselect":null!==n&&e(t).val(n)}}function n(t,a){switch(a){case"text":var n=e(t).val();break;case"number":var n=e(t).val();break;case"textarea":var n=e(t).val();break;case"radio":var n=e(t).val();break;case"checkbox":n=e(t).is(":checked")?"yes":"no";break;case"select":var n=e(t).val();break;case"multiselect":var n=e(t).val()||[]}return n}var s=-1;e(".woopf_customizer").sortable({cursor:"move",start:function(a,n){s=t(n.item,e(".woopf_customizer > span"))},stop:function(a,n){var r=e(".woopf_customizer span.adv").length;if(r>0){var i=0;e(".woopf_customizer span.adv").each(function(){var t=e(this),a=t.attr("data-id");t.find("[name]").each(function(){var t=e(this).attr("name");e(this).attr("name",t.replace("["+a+"]","["+i+"]"))}),t.attr("data-id",i),i++})}var r=e(".woopf_customizer span.rng").length;if(r>0){var i=0;e(".woopf_customizer span.rng").each(function(){var t=e(this),a=t.attr("data-id");t.find("[name]").each(function(){var t=e(this).attr("name");e(this).attr("name",t.replace("["+a+"]","["+i+"]"))}),t.attr("data-id",i),i++})}var _=t(n.item,e(".woopf_customizer > span"));s!=_&&(_>s?e(e("#wc_settings_woopf_active_filters option")[s]).insertAfter(e(e("#wc_settings_woopf_active_filters option")[_])):e(e("#wc_settings_woopf_active_filters option")[s]).insertBefore(e(e("#wc_settings_woopf_active_filters option")[_])))}}),e(document).on("click",".woopf_c_visible",function(){var a=e(this).parent(),n=t(a,e(".woopf_customizer > span"));return a.find(".woopf-eye").length>0?(a.find(".woopf-eye").removeClass("woopf-eye").addClass("woopf-eye-disabled"),e("#wc_settings_woopf_active_filters option").eq(n).prop("selected",!1)):(a.find(".woopf-eye-disabled").removeClass("woopf-eye-disabled").addClass("woopf-eye"),e("#wc_settings_woopf_active_filters option").eq(n).prop("selected",!0)),!1}),e(document).on("click",".woopf_c_delete",function(){var a=e(this).parent(),n=t(a,e(".woopf_customizer > span"));return e("#wc_settings_woopf_active_filters option").eq(n).remove(),e(".woopf_c_add_filter[data-filter="+a.attr("data-filter")+"]").removeClass("pf_active").find("i").removeClass("woopf-eye").addClass("woopf-eye-disabled"),a.remove(),!1}),e(document).on("change",".woopf_adv_select",function(){var t=e(this).parent(),a=t.closest(".adv").attr("data-id"),n={action:"woopf_c_terms",taxonomy:e(this).find("option:selected").attr("value")};e.post(woopf.ajax,n,function(e){e?(e=e.replace(/\%%/g,a),t.next().replaceWith(e)):alert("Error!")})}),e(document).on("click",".woopf_c_add_filter",function(){var t=e(this);if(t.hasClass("pf_active")){if(confirm("Deactivate?")===!1)return;e("#wc_settings_woopf_active_filters option[value="+t.attr("data-filter")+"]").remove(),e(".woopf_customizer span[data-filter="+t.attr("data-filter")+"]").remove(),t.removeClass("pf_active").find("i").removeClass("woopf-eye").addClass("woopf-eye-disabled")}else{if(confirm("Activate?")===!1)return;e("#wc_settings_woopf_active_filters").append('<option value="'+t.attr("data-filter")+'" selected="selected">'+t.find("span").text()+"</option>"),e(".woopf_customizer").append('<span class="pf_element" data-filter="'+t.attr("data-filter")+'"><span>'+t.find("span").text()+'</span><a href="#" class="woopf_c_delete"><i class="woopf-delete"></i></a><a href="#" class="woopf_c_move"><i class="woopf-move"></i></a></span>'),t.addClass("pf_active").find("i").removeClass("woopf-eye-disabled").addClass("woopf-eye")}return!1}),e(document).on("click",".woopf_c_add.pf_advanced",function(){var t=e(this).parent().next(),a=t.find(".pf_element.adv").length,n={action:"woopf_c_fields",pf_id:a};return e.post(woopf.ajax,n,function(a){if(a){a=a.split("%SPLIT%");var n='<span class="pf_element adv" data-filter="advanced" data-id="'+a[0]+'"><span>Advanced Filter</span><a href="#" class="woopf_c_delete"><i class="woopf-delete"></i></a><a href="#" class="woopf_c_move"><i class="woopf-move"></i></a><span class="pf_options_holder">'+a[1]+"</span></span>";e("#wc_settings_woopf_active_filters").append('<option value="advanced" selected="selected">Advanced Filter</option>');t.append(n)}else alert("Error!")}),!1}),e(document).on("click",".woopf_or_add",function(){if(confirm("Add override?")===!1)return!1;var t=e(this).closest("p"),a={action:"woopf_or_add",curr_tax:t.attr("class"),curr_term:t.find(".woopf_or_select").val(),curr_override:t.find(".woopf_filter_presets").val()};return void 0==a.curr_term||"default"==a.curr_override?void alert("Please select both term and filter preset."):(e.post(woopf.ajax,a,function(e){e?(t.prepend('<span class="woopf_override"><input type="checkbox" class="pf_override_checkbox" /> Term slug : <span class="slug">'+t.find(".woopf_or_select").val()+'</span> Filter Preset : <span class="preset">'+t.find(".woopf_filter_presets").val()+'</span> <a href="#" class="button woopf_or_remove">Remove Override</a><span class="clearfix"></span></span>'),alert("Added")):alert("Error!")}),!1)}),e(document).on("click",".woopf_or_remove",function(){if(confirm("Remove override?")===!1)return!1;var t=e(this).closest("p"),a=e(this).parent(),n={action:"woopf_or_remove",curr_tax:t.attr("class"),curr_term:a.find(".slug").text()};return e.post(woopf.ajax,n,function(e){e?(a.remove(),alert("Removed")):alert("Error!")}),!1}),e(document).on("click","#woopf_save",function(){var t={},a=e("input[name^=wc_settings_woopf], select[name^=wc_settings_woopf], textarea[name^=wc_settings_woopf]");if(e.each(a,function(a,s){var r="INPUT"==e(s).prop("tagName")?e(s).attr("type"):e(s).prop("tagName").toLowerCase();t[e(s).attr("name").replace("[]","")]=n(e(s),r)}),e(".pf_element.adv").length>0){var s=0;t.wc_settings_woopf_advanced_filters={},t.wc_settings_woopf_advanced_filters.pfa_title=[],t.wc_settings_woopf_advanced_filters.pfa_taxonomy=[],t.wc_settings_woopf_advanced_filters.pfa_include=[],t.wc_settings_woopf_advanced_filters.pfa_order=[],t.wc_settings_woopf_advanced_filters.pfa_orderby=[],t.wc_settings_woopf_advanced_filters.pfa_multiselect=[],t.wc_settings_woopf_advanced_filters.pfa_relation=[],t.wc_settings_woopf_advanced_filters.pfa_adoptive=[],t.wc_settings_woopf_advanced_filters.pfa_none=[],e(".pf_element.adv").each(function(){var a=e(this);t.wc_settings_woopf_advanced_filters.pfa_title[s]=a.find('input[name^="pfa_title"]').val(),t.wc_settings_woopf_advanced_filters.pfa_taxonomy[s]=a.find('select[name^="pfa_taxonomy"] option:selected').val(),t.wc_settings_woopf_advanced_filters.pfa_include[s]=a.find('select[name^="pfa_include"]').val(),t.wc_settings_woopf_advanced_filters.pfa_order[s]=a.find('select[name^="pfa _order"]').val(),t.wc_settings_woopf_advanced_filters.pfa_orderby[s]=a.find('select[name^="pfa _orderby"]').val(),t.wc_settings_woopf_advanced_filters.pfa_multiselect[s]=a.find('input[name^="pfa_multiselect"]:checked').length>0?"yes":"no",t.wc_settings_woopf_advanced_filters.pfa_relation[s]=a.find('input[name^="pfa_relation"]').val(),t.wc_settings_woopf_advanced_filters.pfa_adoptive[s]=a.find('input[name^="pfa_adoptive"]:checked').length>0?"yes":"no",t.wc_settings_woopf_advanced_filters.pfa_none[s]=a.find('input[name^="pfa_none"]:checked').length>0?"yes":"no",s++})}if(e(".pf_element.rng").length>0){var r=0;t.wc_settings_woopf_range_filters={},t.wc_settings_woopf_range_filters.pfr_title=[],t.wc_settings_woopf_range_filters.pfr_taxonomy=[],t.wc_settings_woopf_range_filters.pfr_include=[],t.wc_settings_woopf_range_filters.pfr_order=[],t.wc_settings_woopf_range_filters.pfr_orderby=[],t.wc_settings_woopf_range_filters.pfr_style=[],t.wc_settings_woopf_range_filters.pfr_grid=[],e(".pf_element.rng").each(function(){var a=e(this);t.wc_settings_woopf_range_filters.pfr_title[r]=a.find('input[name^="pfr_title"]').val(),t.wc_settings_woopf_range_filters.pfr_taxonomy[r]=a.find('select[name^="pfr_taxonomy"] option:selected').val(),t.wc_settings_woopf_range_filters.pfr_include[r]=a.find('select[name^="pfr_include"]').val(),t.wc_settings_woopf_range_filters.pfr_order[r]=a.find('select[name^="pfr_order"]').val(),t.wc_settings_woopf_range_filters.pfr_orderby[r]=a.find('select[name^="pfr_orderby"]').val(),t.wc_settings_woopf_range_filters.pfr_style[r]=a.find('select[name^="pfr_style"] option:selected').val(),t.wc_settings_woopf_range_filters.pfr_grid[r]=a.find('input[name^="pfr_grid"]:checked').length>0?"yes":"no",r++})}var i=prompt("Enter template name to save it",e('select#woopf_filter_presets option:selected:not([value="default"])').val());if(""==i||""==t)return alert("Missing name or settings."),!1;if(null===i)return!1;var _={action:"woopf_admin_save",curr_name:i,curr_settings:JSON.stringify(t)};return e.post(woopf.ajax,_,function(t){t?(0==e('select#woopf_filter_presets option[value="'+_.curr_name+'"]').length&&e("select#woopf_filter_presets").append('<option value="'+_.curr_name+'">'+_.curr_name+"</option>"),alert("Saved")):alert("Error!")}),!1}),e(document).on("click","#woopf_load",function(){if(confirm("Load?")===!1)return!1;var t={action:"woopf_admin_load",curr_name:e("select#woopf_filter_presets option:selected").val()};return""==t.curr_name||"default"==t.curr_name?(alert("Not selected."),!1):(e.post(woopf.ajax,t,function(t){if(t){var n=e.parseJSON(t),s=e("input[name^=wc_settings_woopf], select[name^=wc_settings_woopf], textarea[name^=wc_settings_woopf]");if(e.each(s,function(t,s){var r="INPUT"==e(s).prop("tagName")?e(s).attr("type"):e(s).prop("tagName").toLowerCase();"select"==r&&1==e(s).prop("multiple")&&(r="multiselect");var i=n[e(s).attr("name").replace("[]","")];void 0===i||null===i?"select"==r&&0==e(s).prop("multiple")&&e(s).find("option:first-child").attr("selected","selected").trigger("change"):a(e(s),r,i)}),void 0!==n.wc_settings_woopf_active_filters){var r=e(".woopf_customizer"),i=e(".woopf_customizer_fields");r.empty(),i.find("a.woopf_c_add_filter:not(.pf_advanced)").removeClass("pf_active"),i.find("a.woopf_c_add_filter:not(.pf_advanced) i").removeAttr("class").addClass("woopf-eye-disabled"),e("#wc_settings_woopf_active_filters").empty();var _=0,c=0;e.each(n.wc_settings_woopf_active_filters,function(t,a){if(e("#wc_settings_woopf_active_filters").append('<option value="'+a+'" selected="selected">'+a+"</option>"),"advanced"==a){r.append('<span class="pf_element adv" data-filter="'+a+'" data-id="'+_+'"><span>Advanced Filter</span><a href="#" class="woopf_c_delete"><i class="woopf-delete"></i></a><a href="#" class="woopf_c_move"><i class="woopf-move"></i></a><span class="pf_options_holder"></span></span>');var s={action:"woopf_c_fields",pfa_title:void 0!==n.wc_settings_woopf_advanced_filters.pfa_title?n.wc_settings_woopf_advanced_filters.pfa_title[_]:"",pfa_taxonomy:void 0!==n.wc_settings_woopf_advanced_filters.pfa_taxonomy?n.wc_settings_woopf_advanced_filters.pfa_taxonomy[_]:"",pfa_include:void 0!==n.wc_settings_woopf_advanced_filters.pfa_include?n.wc_settings_woopf_advanced_filters.pfa_include[_]:[],pfa_order:void 0!==n.wc_settings_woopf_advanced_filters.pfa_order?n.wc_settings_woopf_advanced_filters.pfa_order[_]:"",pfa_orderby:void 0!==n.wc_settings_woopf_advanced_filters.pfa_orderby?n.wc_settings_woopf_advanced_filters.pfa_orderby[_]:"DESC",pfa_multiselect:void 0!==n.wc_settings_woopf_advanced_filters.pfa_multiselect?n.wc_settings_woopf_advanced_filters.pfa_multiselect[_]:"no",pfa_relation:void 0!==n.wc_settings_woopf_advanced_filters.pfa_relation?n.wc_settings_woopf_advanced_filters.pfa_relation[_]:"and",pfa_adoptive:void 0!==n.wc_settings_woopf_advanced_filters.pfa_adoptive?n.wc_settings_woopf_advanced_filters.pfa_adoptive[_]:"no",pfa_none:void 0!==n.wc_settings_woopf_advanced_filters.pfa_none?n.wc_settings_woopf_advanced_filters.pfa_none[_]:"no",pf_id:_};e.post(woopf.ajax,s,function(e){e?(e=e.split("%SPLIT%"),r.find('.pf_element.adv[data-id="'+e[0]+'"]').find(".pf_options_holder").append(e[1])):alert("Error!")}),_++}else if("range"==a){r.append('<span class="pf_element rng" data-filter="'+a+'" data-id="'+c+'"><span>Range Filter</span><a href="#" class="woopf_c_delete"><i class="woopf-delete"></i></a><a href="#" class="woopf_c_move"><i class="woopf-move"></i></a><span class="pf_options_holder"></span></span>');var s={action:"woopf_r_fields",pfr_title:void 0!==n.wc_settings_woopf_range_filters.pfr_title?n.wc_settings_woopf_range_filters.pfr_title[c]:"",pfr_taxonomy:void 0!==n.wc_settings_woopf_range_filters.pfr_taxonomy?n.wc_settings_woopf_range_filters.pfr_taxonomy[c]:"",pfr_include:void 0!==n.wc_settings_woopf_range_filters.pfr_include?n.wc_settings_woopf_range_filters.pfr_include[c]:[],pfr_order:void 0!==n.wc_settings_woopf_range_filters.pfr_order?n.wc_settings_woopf_range_filters.pfr_order[c]:"",pfr_orderby:void 0!==n.wc_settings_woopf_range_filters.pfr_orderby?n.wc_settings_woopf_range_filters.pfr_orderby[c]:"DESC",pfr_style:void 0!==n.wc_settings_woopf_range_filters.pfr_style?n.wc_settings_woopf_range_filters.pfr_style[c]:"flat",pfr_grid:void 0!==n.wc_settings_woopf_range_filters.pfr_grid?n.wc_settings_woopf_range_filters.pfr_grid[c]:"no",pf_id:c};e.post(woopf.ajax,s,function(e){e?(e=e.split("%SPLIT%"),r.find('.pf_element.rng[data-id="'+e[0]+'"]').find(".pf_options_holder").append(e[1])):alert("Error!")}),c++}else i.find('a.woopf_c_add_filter[data-filter="'+a+'"]').addClass("pf_active"),i.find('a.woopf_c_add_filter[data-filter="'+a+'"] i').removeAttr("class").addClass("woopf-eye"),r.append('<span class="pf_element" data-filter="'+a+'"><span>'+i.find('a.woopf_c_add_filter[data-filter="'+a+'"] span').text()+'</span><a href="#" class="woopf_c_delete"><i class="woopf-delete"></i></a><a href="#" class="woopf_c_move"><i class="woopf-move"></i></a></span>')})}alert("Loaded")}else alert("Error!")}),!1)}),e(document).on("click","#woopf_delete",function(){if(confirm("Delete?")===!1)return!1;var t={action:"woopf_admin_delete",curr_name:e("select#woopf_filter_presets option:selected").val()};return""==t.curr_name?(alert("Not selected."),!1):(e.post(woopf.ajax,t,function(a){a?(e('select#woopf_filter_presets option[value="'+t.curr_name+'"]').remove(),alert("Deleted")):alert("Error!")}),!1)}),e("#wc_settings_woopf_selected, #wc_settings_woopf_attributes").closest("tr").hide(),e(document).on("click",".woopf_c_add.pf_range",function(){var t=e(this).parent().next(),a=t.find(".pf_element.rng").length,n={action:"woopf_r_fields",pf_id:a};return e.post(woopf.ajax,n,function(a){if(a){a=a.split("%SPLIT%");var n='<span class="pf_element rng" data-filter="range" data-id="'+a[0]+'"><span>Range Filter</span><a href="#" class="woopf_c_delete"><i class="woopf-delete"></i></a><a href="#" class="woopf_c_move"><i class="woopf-move"></i></a><span class="pf_options_holder">'+a[1]+"</span></span>";e("#wc_settings_woopf_active_filters").append('<option value="range" selected="selected">Range Filter</option>');t.append(n)}else alert("Error!")}),!1}),e(document).on("change",".woopf_rng_select",function(){var t=e(this).parent(),a=t.closest(".rng").attr("data-id"),n=e(this).find("option:selected").attr("value"),s={action:"woopf_r_terms",taxonomy:n};e.post(woopf.ajax,s,function(e){e?(e=e.replace(/\%%/g,a),t.next().replaceWith(e),"price"==n?(t.next().next().find("select").prop("disabled",!0),t.next().next().next().find("select").prop("disabled",!0)):(t.next().next().find("select").prop("disabled",!1),t.next().next().next().find("select").prop("disabled",!1))):alert("Error!")})}),e("#woopf_save_default").length>0&&(e('input[name="save"]').before('<a href="#" id="woopf_save_bottom" class="button-primary">'+e("#woopf_save").text()+"</a>"),e('input[name="save"]').val(e("#woopf_save_default").text()),e("#woopf_save_bottom").on("click",function(){return e("#woopf_save").trigger("click"),!1})),e(".woopf_or_select").length>0&&e('input[name="save"]').hide(),e(document).on("click",".woopf_or_remove_selected",function(){var t=e(this).closest("p");return t.find("input.pf_override_checkbox:checked").each(function(){e(this).parent().find(".woopf_or_remove").click()}),!1}),e(document).on("click",".woopf_or_remove_all",function(){var t=e(this).closest("p");return t.find(".woopf_or_remove").click(),!1}),e(document).on("click","#woopf_save_default",function(){var t=e(this).closest("form");return t.submit(),!1}),e(document).on("click","#woopf_reset_default",function(){return window.location.href=window.location.href,!1})}(jQuery);
